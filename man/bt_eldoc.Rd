% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main_functions.R
\name{bt_eldoc}
\alias{bt_eldoc}
\title{Run an ElDoc (Donchian) backtest with quantstrat}
\usage{
bt_eldoc(
  ticker,
  up = 40,
  down = 40,
  ps_risk_value = 2,
  ps = "pct",
  fee = "normal",
  start_date = "1900-01-01",
  end_date = Sys.Date(),
  long = TRUE,
  short = TRUE,
  invert_signals = FALSE,
  normalize_risk = NULL,
  geometric = TRUE,
  verbose = FALSE,
  only_returns = FALSE,
  hide_details = FALSE,
  stop_before_maturity = NULL,
  clean_di = TRUE,
  plot = FALSE
)
}
\arguments{
\item{ticker}{Character symbol or an \code{xts} object (or the name of one in the
global environment) with OHLC data. When an object is supplied, its data is
used directly; otherwise it is fetched via \code{sm_get_data()}.}

\item{up}{Integer Donchian window for the upper channel (default 40).}

\item{down}{Integer Donchian window for the lower channel (default 40).}

\item{ps_risk_value}{Numeric risk percentage (e.g., 2 for 2\%) used by the
position sizing function.}

\item{ps}{Character label for position sizing mode (informational).}

\item{fee}{Either \code{"normal"} (use instrument fees/slippage if available) or
\code{"nofee"} to disable fees.}

\item{start_date}{Character or Date, start date when fetching data.}

\item{end_date}{Date, end date when fetching data (default \code{Sys.Date()}).}

\item{long}{Logical, enable long entries.}

\item{short}{Logical, enable short entries.}

\item{invert_signals}{Logical, invert entry/exit mapping (debug/testing).}

\item{normalize_risk}{Optional numeric target risk used to append
normalized return columns to the output.}

\item{geometric}{Logical, use geometric returns when reporting performance.}

\item{verbose}{Logical, print detailed summaries to the console.}

\item{only_returns}{Logical; if \code{TRUE}, returns only the portfolio returns \code{xts}.}

\item{hide_details}{Logical; if \code{TRUE}, simplifies internal object names.}

\item{plot}{Logical; if \code{TRUE}, plots the portfolio using \code{rTradingPlots::tplot}.}
}
\value{
If \code{only_returns = TRUE}, returns an \code{xts} with discrete and log
returns. Otherwise, returns a named list with elements:
\itemize{
\item \code{rets}: portfolio returns \code{xts}
\item \code{stats}: \code{tradeStats} output with additional metadata
\item \code{trades}: transactions \code{xts}
\item \code{rets_acct}: account-level returns \code{xts}
\item \code{mktdata}: market data with indicator columns
}
}
\description{
Configures a simple Donchian breakout system using \code{quantstrat} where entries
occur on price crossing the upper/lower channel and exits occur on the
opposite channel signal. Position sizing can be percentage-of-equity (Donchian)
or DI-specific sizing, detected by the symbol prefix.
}
\details{
Data is fetched from \code{rSenhorMercadoAPI::sm_get_data()} if the symbol is not
found in the global environment; otherwise the preloaded object is used.

The function builds the strategy, runs the backtest, prints key summaries, and
returns a list of results.

If the symbol starts with \code{"DI1"}, DI-specific position sizing is used,
otherwise a Donchian risk-based sizing is applied. Instrument metadata
(multiplier, tick size, maturity) is propagated when available.
}
